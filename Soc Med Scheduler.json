{
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        0,
        32
      ],
      "id": "973203bc-5cee-4e80-b113-6252fea425c5",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "resource": "base",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        208,
        32
      ],
      "id": "d4981f97-14d9-4761-9e60-8cc628251d9a",
      "name": "Get all database",
      "credentials": {
        "airtableTokenApi": {
          "id": "kNpTbg9ru1jeBchc",
          "name": "Airtable Personal Access Token account"
        }
      }
    },
    {
      "parameters": {
        "resource": "base",
        "operation": "getSchema",
        "base": {
          "__rl": true,
          "value": "appKnxjka7xe3ja2D",
          "mode": "list",
          "cachedResultName": "Social Media Posting Scheduler",
          "cachedResultUrl": "https://airtable.com/appKnxjka7xe3ja2D"
        }
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        416,
        32
      ],
      "id": "a96d9cf7-4e5d-443b-b3a5-4936ab5e3211",
      "name": "get all table",
      "credentials": {
        "airtableTokenApi": {
          "id": "kNpTbg9ru1jeBchc",
          "name": "Airtable Personal Access Token account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "1e523a86-d79e-4433-9c08-d05394b34452",
              "name": "tbl_id",
              "value": "={{ $json.id }}",
              "type": "string"
            },
            {
              "id": "991dbf15-46d6-4902-84df-8797056c47c2",
              "name": "base_id",
              "value": "={{ $('Get all database').item.json.id }}",
              "type": "string"
            },
            {
              "id": "b89daf42-dcb7-402b-a705-6579be2c3b7c",
              "name": "base_name",
              "value": "={{ $('Get all database').item.json.name }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        624,
        32
      ],
      "id": "060b5a76-d286-414b-a8b7-7a6382a48f81",
      "name": "get tbl_id, base_id and base_name"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        1040,
        128
      ],
      "id": "c2e42e27-10ad-48e5-aba3-e4c2cca20fc1",
      "name": "No Operation, do nothing"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "e8c6b52a-cbbb-470a-8270-cfd6ba809d27",
              "leftValue": "={{ $json.base_name }}",
              "rightValue": "Social Media Posting Scheduler",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        832,
        32
      ],
      "id": "25faacb9-ddc2-4996-8fcd-21f98d4c7e8d",
      "name": "route base on db name"
    },
    {
      "parameters": {
        "url": "=https://api.airtable.com/v0/{{ $json.base_id }}/{{ $json.tbl_id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer // Put your Airtable API Key here"
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.4,
      "position": [
        1040,
        -64
      ],
      "id": "c7ef69db-e3f1-434f-a86e-2b3ed754756a",
      "name": "get all data from database"
    },
    {
      "parameters": {
        "fieldToSplitOut": "records",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        1232,
        -64
      ],
      "id": "b04411ae-6a85-4364-b7c6-ccc48e11c594",
      "name": "Split Out"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "41670e12-62ed-498c-95db-d3c374d3b08b",
              "leftValue": "={{ $json.fields.Message }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "0dec7b7d-7d1e-47d6-8ab6-3125ffd85696",
              "leftValue": "={{ $json.fields[\"Scheduled Date & Time\"] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1440,
        -64
      ],
      "id": "efee71e5-bbd4-4688-bd32-9dd5f52c7753",
      "name": "filter missing data"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "45c273b2-2ac7-43f6-82e7-3e814c616442",
              "name": "formatted_date_number",
              "value": "={{ DateTime.fromISO($json.fields[\"Scheduled Date & Time\"]).toMillis() }}",
              "type": "number"
            },
            {
              "id": "f8eb1d7e-8b06-4b60-b707-fe087a9f7f1f",
              "name": "current_date_number",
              "value": "={{ DateTime.now().toMillis() }}",
              "type": "number"
            },
            {
              "id": "c872b141-eb54-4c64-aab0-f8bda31f1a85",
              "name": "tbl_ID",
              "value": "={{ $json.fields.ID }}",
              "type": "number"
            },
            {
              "id": "dc08b803-1179-4f13-b819-1126b2d67b6d",
              "name": "Message",
              "value": "={{ $json.fields.Message }}",
              "type": "string"
            },
            {
              "id": "495d4796-7649-4d5b-b6d9-95eb03545864",
              "name": "Status",
              "value": "={{ $json.fields.Status }}",
              "type": "string"
            },
            {
              "id": "05a5f1fd-6848-48f9-9e88-c79dbba9086b",
              "name": "Image_Url",
              "value": "={{ $json.fields.Attachments[0].url }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1632,
        -192
      ],
      "id": "286546fa-75c3-47e0-9d53-05effee422d9",
      "name": "format date to millis"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "99121e20-d580-4c54-aab2-bdc7aa42e5f3",
              "leftValue": "={{ $json.formatted_date_number }}",
              "rightValue": "={{ $json.current_date_number }}",
              "operator": {
                "type": "number",
                "operation": "lte"
              }
            },
            {
              "id": "b38ea5ac-410c-4617-9623-9f22f4d94794",
              "leftValue": "={{ $json.Status }}",
              "rightValue": "Ready",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1840,
        -192
      ],
      "id": "bc198bfd-784f-4bfc-a8a6-3009afc33b22",
      "name": "route > date.now data"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        2080,
        80
      ],
      "id": "4440fa32-2b42-49f7-80b6-31e602146d15",
      "name": "< date.now data"
    },
    {
      "parameters": {
        "url": "={{ $json.Image_Url }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.4,
      "position": [
        2080,
        -368
      ],
      "id": "a19ea9c5-88f3-408d-b06a-b8960ac6ee07",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "resource": "file",
        "options": {
          "channelId": "=C0AGFJDNJEQ",
          "initialComment": "={{ $json.Message }}"
        }
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.4,
      "position": [
        2400,
        -544
      ],
      "id": "080da955-8a4d-419c-8f2a-a8e621780dd4",
      "name": "Upload a file",
      "webhookId": "6f37cef6-c406-4252-b2a2-6283cfd4785b",
      "credentials": {
        "slackApi": {
          "id": "HkKXx7JRpJNprWPX",
          "name": "v2 Social Medial Poster Bot"
        }
      }
    },
    {
      "parameters": {
        "content": "Binary"
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2000,
        -400
      ],
      "typeVersion": 1,
      "id": "4e8941b0-368c-4791-844f-31a69c3ccf4a",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "operation": "sendPhoto",
        "chatId": "-1003854177863",
        "binaryData": true,
        "additionalFields": {
          "caption": "={{ $json.Message }}"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2400,
        -224
      ],
      "id": "13337b68-25e8-440b-b62d-05dcf5484435",
      "name": "Send a photo message",
      "webhookId": "66099f16-a56c-4009-9ebf-bc0c71622049",
      "credentials": {
        "telegramApi": {
          "id": "59SPjhEdqis5fl5t",
          "name": "Social_Media_V2_Poster_bot"
        }
      }
    },
    {
      "parameters": {
        "content": "Get Chat ID: https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates",
        "height": 256,
        "width": 272
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2320,
        -320
      ],
      "typeVersion": 1,
      "id": "459c2097-178c-4c58-8e0d-4b00d6dbc059",
      "name": "Sticky Note1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2720,
        -400
      ],
      "id": "733854e1-6a26-4742-a41d-a33ee8babc56",
      "name": "Merge"
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "appKnxjka7xe3ja2D",
          "mode": "list",
          "cachedResultName": "Social Media Posting Scheduler",
          "cachedResultUrl": "https://airtable.com/appKnxjka7xe3ja2D"
        },
        "table": {
          "__rl": true,
          "value": "tblgLAsGdV7YRrviM",
          "mode": "list",
          "cachedResultName": "All Data",
          "cachedResultUrl": "https://airtable.com/appKnxjka7xe3ja2D/tblgLAsGdV7YRrviM"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Status": "Posted",
            "ID": "={{ $json.tbl_ID }}",
            "Message": "={{ $json.Message }}"
          },
          "matchingColumns": [
            "ID"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "ID",
              "displayName": "ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Attachments",
              "displayName": "Attachments",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "array",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Scheduled Date & Time",
              "displayName": "Scheduled Date & Time",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Ready",
                  "value": "Ready"
                },
                {
                  "name": "Posted",
                  "value": "Posted"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Date & Time Posted",
              "displayName": "Date & Time Posted",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        3152,
        -400
      ],
      "id": "4d949ba3-e2be-4b36-b281-ea8fcede2ea3",
      "name": "Update record1",
      "credentials": {
        "airtableTokenApi": {
          "id": "kNpTbg9ru1jeBchc",
          "name": "Airtable Personal Access Token account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6867c6fd-6bd6-43b6-9660-303d44bf92c3",
              "name": "tbl_ID",
              "value": "={{ $('HTTP Request').item.json.tbl_ID }}",
              "type": "number"
            },
            {
              "id": "6dd2ec08-aa84-4405-b69d-b2a050d47ee8",
              "name": "Message",
              "value": "={{ $('HTTP Request').item.json.Message }}",
              "type": "string"
            },
            {
              "id": "91b01efd-ab8d-4488-a0d5-100c3018f2e8",
              "name": "Status",
              "value": "={{ $('HTTP Request').item.json.Status }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2928,
        -400
      ],
      "id": "1d9bb4cb-e62a-4a70-a93a-8e76a1e8f3ff",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "deleteRecord",
        "base": {
          "__rl": true,
          "value": "appKnxjka7xe3ja2D",
          "mode": "list",
          "cachedResultName": "Social Media Posting Scheduler",
          "cachedResultUrl": "https://airtable.com/appKnxjka7xe3ja2D"
        },
        "table": {
          "__rl": true,
          "value": "tblgLAsGdV7YRrviM",
          "mode": "list",
          "cachedResultName": "All Data",
          "cachedResultUrl": "https://airtable.com/appKnxjka7xe3ja2D/tblgLAsGdV7YRrviM"
        },
        "id": "={{ $json.id }}"
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        1648,
        32
      ],
      "id": "c6ff0041-80dd-42bd-9785-9b045a07b5a1",
      "name": "Delete a record",
      "credentials": {
        "airtableTokenApi": {
          "id": "kNpTbg9ru1jeBchc",
          "name": "Airtable Personal Access Token account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "jhonrowel02@gmail.com",
        "subject": "Successful Upload",
        "emailType": "text",
        "message": "=✅ Upload Successful \n\nThe scheduled post has been successfully processed and published across all selected platforms (Telegram and Slack).\n\nNo errors detected.",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.2,
      "position": [
        3360,
        -400
      ],
      "id": "462c50cb-cb0a-48b0-a135-024c37b805f1",
      "name": "Send a message",
      "webhookId": "482a6c1f-1e3d-4c8d-bae0-db7ea04082f9",
      "credentials": {
        "gmailOAuth2": {
          "id": "WXHdvvRElKrNo3Z7",
          "name": "Gmail account"
        }
      }
    }
  ],
  "connections": {
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "Get all database",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get all database": {
      "main": [
        [
          {
            "node": "get all table",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get all table": {
      "main": [
        [
          {
            "node": "get tbl_id, base_id and base_name",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get tbl_id, base_id and base_name": {
      "main": [
        [
          {
            "node": "route base on db name",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "route base on db name": {
      "main": [
        [
          {
            "node": "get all data from database",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get all data from database": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "filter missing data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "filter missing data": {
      "main": [
        [
          {
            "node": "format date to millis",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Delete a record",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "format date to millis": {
      "main": [
        [
          {
            "node": "route > date.now data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "route > date.now data": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "< date.now data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Upload a file",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send a photo message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload a file": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a photo message": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update record1": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Update record1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "01bd4620b4649c903b620903e464601563d7a6be3b8651e5ba2fc40ace6f1e2c"
  }
}
